<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Making your elastic cluster perform</title>

    <meta name="description" content="A presentation explaining the steps to take to run a healthy elastic cluster">
    <meta name="author" content="Jettro Coenradie">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/solarized.css" id="theme">

    <!-- Code syntax highlighting -->
    <!--<link rel="stylesheet" href="lib/css/tomorrow-night-bright.css">-->
    <link rel="stylesheet" href="lib/css/idea.css">
    <!--<link rel="stylesheet" href="node_modules/highlight.js/styles/zenburn.css">-->
    <style>
        .reveal .slides section .fragment.current-only {
            opacity: 1;
            visibility: visible;
            display: none;
        }

        .reveal .slides section .fragment.current-only.current-fragment {
            display: block;
        }

        .line {
            display: block;
        }

        .line.focus {
            background: yellow;
        }

        .callout {
            color: #0e90d2;
        }
    </style>
    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>

<div class="reveal">

    <!-- Any section element inside of this container is displayed as a slide -->
    <div class="slides">
        <section>
            <h1>Making your elastic cluster perform</h1>
            <p>
                <small>Created by <a href="http://twitter.com/jettroCoenradie">@jettroCoenradie</a></small>
            </p>
            <p>
                <img src="/lib/images/luminisams_logo.png">
            </p>
        </section>

        <section>
            <h2>Why use Elasticsearch</h2>
            <img src="/lib/images/elastic-logo.png">
        </section>

        <section>
            <section>
                <img src="/lib/images/comingto/using-search.png">
            </section>
            <section>
                <img src="/lib/images/comingto/log-monitoring.png">
            </section>
            <section>
                <img src="/lib/images/comingto/cool-kibana-dashboard.png">
            </section>
        </section>

        <section>
            <h2>Start with Elasticsearch</h2>
            <img src="/lib/images/elastic-logo.png">
        </section>
        <section>
            <section>
                <img src="/lib/images/firststeps/downloading-elasticsearch.png">
            </section>
            <section>
                <img src="/lib/images/firststeps/starting-elasticsearch.png">
            </section>
            <section>
                <pre><code>
curl 'localhost:9200?pretty'
                </code></pre>
<pre><code>
{
  "name" : "Tatterdemalion",
  "cluster_name" : "elasticsearch",
  "version" : {
    "number" : "2.3.1",
    "build_hash" : "bd980929010aef404e7cb0843e61d0665269fc39",
    "build_timestamp" : "2016-04-04T12:25:05Z",
    "build_snapshot" : false,
    "lucene_version" : "5.5.0"
  },
  "tagline" : "You Know, for Search"
}

</code></pre>
                <p class="fragment" data-code-focus="2"/>
                <p class="fragment" data-code-focus="5"/>
                <p class="fragment" data-code-focus="6"/>
            </section>
            <section>
            <pre><code>
curl -XPOST 'localhost:9200/conferences/conference/1?pretty' -d '
{
  "name": "Codemotion Amsterdam",
  "location": "Kromhouthal"
}'
			</code></pre>
                <!--<pre><code>-->
<!--{-->
  <!--"_index" : "conferences",-->
  <!--"_type" : "conference",-->
  <!--"_id" : "1",-->
  <!--"_version" : 1,-->
  <!--"_shards" : {-->
    <!--"total" : 2,-->
    <!--"successful" : 1,-->
    <!--"failed" : 0-->
  <!--},-->
  <!--"created" : true-->
<!--}-->
                </code></pre>
                <!--<p class="fragment" data-code-focus="2-6"/>-->
                <!--<p class="fragment" data-code-focus="18"/>-->
            </section>
            <aside class="notes">
                First show how easy it is to start you node / cluster, insert documents and query them.
            </aside>
        </section>


        <section>
            <h2>That was easy!</h2>
            <aside class="notes">
                But there are a lot of choices to be made. This way only the defaults are used. These are often
                not what you want.
            </aside>
        </section>

        <section>
            <img src="/lib/images/firststeps/presentation-overview.png">
        </section>

        <section>
            <h2>Design your cluster</h2>
            <div style="float: left">
                <img src="/lib/images/elastic-logo.png">
            </div>
            <div>
                <br/>
                <p>How to install and configure?</p>
                <p>How many nodes?</p>
                <p>What hardware?</p>
            </div>
        </section>
        <section>
            <section>
                <h2>Installation</h2>
                <p class="fragment">Just download, unzip and run</p>
                <p class="fragment">Use package manager: yum, apt</p>
                <p class="fragment">Use ansible, chef or puppet</p>
            </section>
            <section>
                <h2>Configuration</h2>
                <p>/etc/defaults/elasticsearch</p>
                <p>/etc/elasticsearch/elasticsearch.yml</p>
                <aside class="notes">
                    Important to explain that elasticsearch.yml is used to configure the node and the other file is
                    meant to configure the process and pass some environment variables.
                </aside>
            </section>
            <section>
                <h3>/etc/defaults/elasticsearch</h3>
                <pre><code>
# Heap size defaults to 256m min, 1g max
# Set ES_HEAP_SIZE to 50% of available RAM, but no more than 31g
ES_HEAP_SIZE=2g
                </code></pre>
                <p class="fragment" data-code-focus="4"/>
            </section>
            <section>
                <h3>/etc/elasticsearch/elasticsearch.yml</h3>
                <pre><code class="hljs">
cluster.name: playground
node.name: node-1
discovery.zen.ping.unicast.hosts: ["node-1", "node-2", "node-3"]
discovery.zen.minimum_master_nodes: 2
path.repo: /opt/es_snapshots/
script.inline: true
                </code></pre>
                <p class="fragment" data-code-focus="2-3"/>
                <p class="fragment" data-code-focus="4-5"/>
                <p class="fragment" data-code-focus="6-7"/>
                <aside class="notes">
                    There is a lot to tell about scripting, there are so many fine grained options to configure what
                    you allow to do with scripts.
                    https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-scripting.html
                </aside>
            </section>

            <section>
                <p>How many nodes do I need?</p>
            </section>
            <section>
                <div style="float: left">
                    <img src="lib/images/cluster/1-node.png">
                </div>
                <div>
                    <p>Development / non-critical</p>
                </div>
            </section>
            <section>
                <div style="float: left">
                    <img src="lib/images/cluster/3-node.png">
                </div>
                <div>
                    <p>Small production</p>
                </div>
                <aside class="notes">
                    Think about split brain, minimum master nodes (n/2 + 1), Master is responsible for health of the
                    cluster
                </aside>
            </section>
            <section>
                <div style="float: left">
                    <img src="lib/images/cluster/n-node.png" width="80%">
                </div>
                <div>
                    <p>Large production</p>
                </div>
                <aside class="notes">
                    https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-node.html
                </aside>
            </section>

            <section>
                <p>What hardware do I need?</p>
            </section>

            <section>
                <h3>Hardware</h3>
                <ul>
                    <li>Prefer cores over clock speed</li>
                    <li>Choose between 8-64Gb</li>
                    <li>Prefer SSD</li>
                </ul>
            </section>
            <aside class="notes">
                Talk about the number of nodes, the type of nodes, and a bit of connecting using clients.
            </aside>
        </section>

        <section>
            <h2>Design your indices</h2>
            <div style="float: left">
                <img src="/lib/images/elastic-logo.png">
            </div>
            <div>
                <br/>
                <p>How many shards?</p>
                <p>How many replicas?</p>
                <p>Time based indices?</p>
            </div>
        </section>

        <section>
            <section>
                <p>What does an index look like?</p>
            </section>
            <section>
                <img src="/lib/images/indexing/indexstructure.png">
            </section>
            <section>
                <p>How many shards do I need?</p>
                <ul>
                    <li class="fragment">Amount of docs or terms</li>
                    <li class="fragment">Indexing speeds</li>
                    <li class="fragment">Not bigger than than 50Gb</li>
                    <li class="fragment">Why not a lot of shards?</li>
                    <li class="fragment">Start small and test</li>
                </ul>
            </section>
            <section>
                <p>How many replicas do I need?</p>
            </section>
            <section>
                <p>Should I use Types?</p>
            </section>
            <section>
                <p>Should I use Aliases?</p>
            </section>
            <section>
                <p>Working with time based indices?</p>
                <ul>
                    <li class="fragment">Option to change shards per time period</li>
                    <li class="fragment">Use index templates</li>
                </ul>
            </section>
            <aside class="notes">
                So you have your cluster running, it has enough nodes and each node is configured with enough memory.
                A very important thing to consider is whether you are using time based indices. Than think about
                the amount of shards that you would need and of course the amount of replicas.
            </aside>
        </section>

        <section>
            <h2>Design your mapping</h2>
            <div style="float: left">
                <img src="/lib/images/elastic-logo.png">
            </div>
            <div>
                <br/>
                <p>Do I need a mapping?</p>
                <p>What do analyzers do?</p>
                <p>Do I need an analyzer?</p>
            </div>
        </section>

        <section>
            <p>The default uses dynamic type mapping</p>
            <p class="fragment">Make your mapping explicit: Date, Geo_point, long</p>
            <p class="fragment">disable dynamic type mapping</p>
            <pre class="fragment"><code>
PUT /_settings
{
  "index.mapper.dynamic":false
}
            </code></pre>
        </section>

        <section>
            <section>
                <p>A mapping is persistent, can only add new things.</p>
            </section>
            <section>
                <p>Use multi field mapping: <span class="callout">name</span></p>
                <pre><code class="hljs" data-trim contenteditable>
PUT /conferences
{
  "mappings": {
    "conference": {
      "properties": {
        "name": {
          "type": "string",
          "analyzer": "standard",
          "fields": {
            "raw": {
              "type": "string",
              "index": "not_analyzed"
            }
          }
        }
}}}}
                </code></pre>
                <p class="fragment" data-code-focus="6"/>
                <p class="fragment" data-code-focus="7-8"/>
                <p class="fragment" data-code-focus="9-14"/>
                <p class="fragment" data-code-focus="12"/>
            </section>
            <section>
                <p>An analyzer creates terms out of data</p>
                <div class="fragment">
                    <p>Has three components:</p>
                    <ul>
                        <li class="fragment"><span class="callout">Character filter</span>  - replace & with and</li>
                        <li class="fragment"><span class="callout">Tokenizer</span> - on whitespace, regexp, ngrams</li>
                        <li class="fragment"><span class="callout">Filters</span> - ascii folding, language specific, lowercase, stop words</li>
                    </ul>
                </div>
            </section>
            <!--<section>-->
                <!--<img src="/lib/images/indices/analyzer-base.png">-->
            <!--</section>-->
            <!--<section>-->
                <!--<img src="/lib/images/indices/analyzer-start.png">-->
            <!--</section>-->
            <!--<section>-->
                <!--<img src="/lib/images/indices/analyzer-charfilter.png">-->
            <!--</section>-->
            <!--<section>-->
                <!--<img src="/lib/images/indices/analyzer-tonizer.png">-->
            <!--</section>-->
            <!--<section>-->
                <!--<img src="/lib/images/indices/analyzer-tokenfilter.png">-->
            <!--</section>-->
            <!--<section>-->
                <!--<img src="/lib/images/indices/analyzer-analyzer.png">-->
            <!--</section>-->
            <section>
                <h3>Choose the right analyzer for the job</h3>
                <p class="fragment">Custom using tokenizer and filters combinations</p>
                <p class="fragment">Use the multi field approach for special analyzers.</p>
                <p class="fragment">Do not analyze if you don't need it.</p>
            </section>
        </section>

        <section>
            <h2>Indexing documents</h2>
            <div style="float: left">
                <img src="/lib/images/elastic-logo.png">
            </div>
            <div>
                <br/>
                <p>How to improve indexing performance?</p>
            </div>
        </section>
        <section>
            <section>
                <p>What happens when we index a document?</p>
            </section>
            <section>
                <img src="/lib/images/indexing/base.png">
            </section>
            <section>
                <img src="/lib/images/indexing/index-doc.png">
            </section>
            <section>
                <img src="/lib/images/indexing/index-doc-2.png">
            </section>
            <section>
                <img src="/lib/images/indexing/refresh.png">
            </section>
            <section>
                <img src="/lib/images/indexing/more-docs.png">
            </section>
            <section>
                <img src="/lib/images/indexing/flush.png">
            </section>
        </section>
        <section>
            <h3>Tips</h3>
            <section>
                <h3>Use Bulk</h3>
                <p>Bulk request should be between 5-15Mb max</p>
                <p>Round robin requests over nodes</p>
            </section>
            <section>
                <h3>Disable or decrease refresh rate</h3>
                <pre><code class="hljs" data-trim>
curl -XGET 'http://localhost:9200/meetups/_settings' -d '{
    "index" : {
        "refresh_interval" : "-1"
    } }'
                </code></pre>
            </section>
            <section>
                <h3>Index without replicas</h3>
                <pre><code class="hljs" data-trim>
curl -XGET 'http://localhost:9200/meetups/_settings' -d '{
    "index" : {
        "number_of_replicas" : 0
    } }'
                </code></pre>
            </section>
            <aside class="notes">
                <p>Choose the correct bulk size, usually each bulk should be between 5-15Mb</p>
                <p>Round-robin your bulk requests over the nodes, or one node could get flooded based on the memory
                    requirements of a bulk</p>
                https://www.elastic.co/guide/en/elasticsearch/guide/2.x/indexing-performance.html
            </aside>
        </section>

        <section>
            <h2>Querying documents</h2>
            <div style="float: left">
                <img src="/lib/images/elastic-logo.png">
            </div>
            <div>
                <br/>
                <p>How to make queries faster?</p>
                <!--<p>How to influence the score?</p>-->
            </div>
        </section>
        <section>
            <section>
                <pre><code class="hljs" data-trim >
curl -XGET 'http://localhost:9200/_search'
                </code></pre>
            </section>
            <section>
                <img src="/lib/images/indices/overview.png">
            </section>
            <section>
                <img src="/lib/images/indices/playground.png">
            </section>
            <section>
                <img src="/lib/images/indices/playground-query.png">
            </section>
            <section>
                <img src="/lib/images/indices/logs.png">
            </section>
            <section>
                <img src="/lib/images/indices/logs-query.png">
            </section>
            <section>
                <pre><code data-trim>
curl -XGET 'http://localhost:9200/meetups/_search?
              q=venue.city:amsterdam%20AND%20description:elasticsearch
              &pretty'
                </code></pre>
            </section>
            <section>
                <pre><code data-trim>
curl -XGET "http://localhost:9200/meetups/_search" -d'
{
  "query": {
    "bool": {
      "must": [
        {
          "match": {
            "venue.city": "amsterdam"
          }
        },
        {
          "match": {
            "description": "elasticsearch"
          }
        }
      ]
}}}'
                </code></pre>
            </section>
            <section>
                <p>How to make a query Faster?</p>
            </section>
            <section>
                <pre><code data-trim>
curl -XGET "http://localhost:9200/meetups/_search" -d'
{
  "query": {
    "bool": {
      "must": [
        {
          "match": {
            "description": "elasticsearch"
          }
        }
      ],
      "filter": {
        "term": {
          "venue.city.raw": "Amsterdam"
        }
      }
    }}}'
                </code></pre>
                <p class="fragment" data-code-focus="12-16"/>
                <p class="fragment" data-code-focus="14"/>
                <aside class="notes">
                    Talk about the difference between query and filter context. A query calculates a score, a filter
                    does not need a score. It is a yes/no answer. Also mention using the not_analyzed fields.
                </aside>
            </section>
            <section>
                <table>
                    <thead>
                    <tr>
                        <th>Query context</th>
                        <th>Filter context</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr class="fragment">
                        <td>How well does it match?</td>
                        <td>Does it match?</td>
                    </tr>
                    <tr class="fragment">
                        <td>Calculates <span class="callout">score</span></td>
                        <td>true/false</td>
                    </tr>
                    <tr class="fragment">
                        <td>Not-cacheable</td>
                        <td><span class="callout">Cacheable</span></td>
                    </tr>
                    </tbody>
                </table>
                <p></p>
                <p></p>
            </section>
            <section>
                <p>Use filter context if you do not need a score</p>
                <p class="fragment">Don't ask for hits if you do not use them</p>
                <p class="fragment">Request only the fields that you need</p>
            </section>
            <section>
                <pre><code data-trim>
curl -XGET "http://localhost:9200/meetups/_search" -d'
{
  "_source": {
    "include": ["venue.*", "group.name", "name"]
  },
  "query": {
    "simple_query_string": {
      "query": "elastic OR elasticsearch"
    }
  }
}'
                </code></pre>
                <p class="fragment" data-code-focus="3-5"/>
            </section>
            <!--<section>-->
                <!--<h3>Some query types available</h3>-->
                <!--<ul>-->
                    <!--<li>Full text - Match, Query String, Common Terms</li>-->
                    <!--<li>Term level - Term, Range, Exist, Missing</li>-->
                    <!--<li>Compound - Bool, Function score</li>-->
                    <!--<li>Geo - GeoShape, Geo Bounding Box, Geo Distance</li>-->
                <!--</ul>-->
            <!--</section>-->
            <section>
                <p>Profile api to learn about the performance</p>
                <pre><code>"profile": true</code></pre>
                <aside class="notes">DEMO</aside>
            </section>

            <!--<section>-->
                <!--<p>How to influence the score?</p>-->
            <!--</section>-->

            <!--<section>-->
                <!--<pre><code data-trim>-->
<!--curl -XGET "http://localhost:9200/meetups/_search" -d'-->
<!--{-->
  <!--"query": {-->
    <!--"function_score": {-->
      <!--"query": {"match": {"_all": "elastic elasticsearch"}-->
      <!--},-->
      <!--"functions": [-->
        <!--{-->
          <!--"gauss": {-->
            <!--"venue.location": {-->
              <!--"origin": {-->
                <!--"lat": 52.0607,-->
                <!--"lon": 4.494-->
              <!--},-->
              <!--"scale": "2km"-->
            <!--}-->
          <!--}-->
        <!--}-->
      <!--]-->
    <!--}-->
  <!--}-->
<!--}'-->
                <!--</code></pre>-->
            <!--</section>-->
            <!--<section>-->
                <!--<p>Explain api to learn about the scoring</p>-->
                <!--<pre><code>"explain": true</code></pre>-->
                <!--<aside class="notes">DEMO</aside>-->
            <!--</section>-->
        </section>

        <section>
            <h2>Analytics from documents</h2>
            <div style="float: left">
                <img src="/lib/images/elastic-logo.png">
            </div>
            <div>
                <br/>
                <p>Why use not_analyzed fields?</p>
            </div>
        </section>

        <section>
            <section>
                <p>Aggregations, maybe the reason why elasticsearch became so popular</p>
            </section>
            <section>
                <pre><code data-trim>
curl -XGET "http://localhost:9200/meetups/_search" -d'
{
  "size": 0,
  "aggs": {
    "byCity": {
      "terms": {
        "field": "venue.city.raw",
        "size": 10
      }
    }
  }
}'
                </code></pre>
                <p class="fragment" data-code-focus="7"/>
            </section>
            <section>
                <pre><code data-trim>
"buckets": [
    {
      "key": "Amsterdam",
      "doc_count": 8
    },
    {
      "key": "Ede",
      "doc_count": 1
    },
    {
      "key": "Leidschendam",
      "doc_count": 1
    },
    {
      "key": "Rotterdam",
      "doc_count": 1
    }
]
                </code></pre>
                <p class="fragment" data-code-focus="2-4"/>
            </section>
            <section>
                <img src="/lib/images/aggregations/kibana-map.png"/>
            </section>
            <section>
                <p>Inverted index not suitable for aggregations</p>
            </section>
            <section>
                <h3>doc_values</h3>
                <p>Stored on disk during indexing</p>
                <p>All fields except analyzed strings</p>
            </section>
            <section>
                <h3>fielddata</h3>
                <p>For analyzed strings</p>
                <p>Stored in the heap</p>
            </section>
        </section>

        <section>
            <h2>Monitoring the cluster</h2>
            <div style="float: left">
                <img src="/lib/images/elastic-logo.png">
            </div>
            <div>
                <br/>
                <p>How can I see what elastic is doing?</p>
                <p>What numbers are important?</p>
            </div>
        </section>

        <section>
            <section>
                <pre><code data-trim>GET /_cluster/health</code></pre>
                <pre><code data-trim>
{
  "cluster_name": "playground",
  "status": "yellow",
  "timed_out": false,
  "number_of_nodes": 1,
  "number_of_data_nodes": 1,
  "active_primary_shards": 55,
  "active_shards": 55,
  "relocating_shards": 0,
  "initializing_shards": 0,
  "unassigned_shards": 16,
  "delayed_unassigned_shards": 0,
  "number_of_pending_tasks": 0,
  "number_of_in_flight_fetch": 0,
  "task_max_waiting_in_queue_millis": 0,
  "active_shards_percent_as_number": 77.46478873239437
}
                </code></pre>
                <p class="fragment" data-code-focus="3"/>
                <p class="fragment" data-code-focus="11"/>
            </section>
            <section>
                <pre><code data-trim>GET /_cluster/health?level=indices</code></pre>
                <pre><code data-trim>
"indices": {
    "conferences": {
      "status": "yellow",
      "number_of_shards": 5,
      "number_of_replicas": 1,
      "active_primary_shards": 5,
      "active_shards": 5,
      "relocating_shards": 0,
      "initializing_shards": 0,
      "unassigned_shards": 5
    }
}
                </code></pre>
                <p class="fragment" data-code-focus="3"/>
                <p class="fragment" data-code-focus="5"/>
                <p class="fragment" data-code-focus="10"/>
            </section>
            <section>
                <pre><code data-trim>GET /_nodes/stats?human</code></pre>
                <ul>
                    <li class="fragment">indices - field_data, filter_cache</li>
                    <li class="fragment">os - cpu, memory, load</li>
                    <li class="fragment">process - file descriptors, cpu, memory</li>
                    <li class="fragment">jvm - memory, garbage collection</li>
                    <li class="fragment">thread_pool - threads, rejected</li>
                    <li class="fragment">fs - disk space</li>
                </ul>
                <aside class="notes">
                    Stats can also be requested for the complete cluster or only for a specific index.
                </aside>
            </section>
            <!--<section>-->
                <!--<pre><code data-trim>GET /_cluster/pending_tasks</code></pre>-->
                <!--<p>Should return an empty array, but ...</p>-->
            <!--</section>-->
            <section>
                <h3>_cat api</h3>
                <pre class="fragment"><code data-trim>
GET /_cat/health?v
epoch      timestamp cluster    status node.total node.data shards pri relo init unassign pending_tasks max_task_wait_time active_shards_percent
1462882362 14:12:42  playground yellow          1         1     56  56    0    0       17             0                  -                 76.7%
                </code></pre>
                <pre class="fragment"><code data-trim>
                    GET /_cat/indices?v
health status index                     pri rep docs.count docs.deleted store.size pri.store.size
green  open   gridshore-logs-2016.01.19   5   0       1007            0      1.2mb          1.2mb
green  open   .kibana                     1   0        100            1    100.2kb        100.2kb
yellow open   topbeat-2016.05.04          5   1     170264            0     44.4mb         44.4mb
green  open   meetups-20160509113909      1   0         11            0     67.3kb         67.3kb
                </code></pre>
                <pre class="fragment"><code data-trim>
                    GET /_cat/fielddata?v
id                     host      ip        node    total
aqj9L-DPR86J8CgYitcHsA 127.0.0.1 127.0.0.1 node-JC    0b
                </code></pre>
            </section>
        </section>
        <section>
            <img src="/lib/images/monitoring/marvel-screenshot.png"/>
        </section>

        <section>
            <h2>Cluster logs</h2>
            <div style="float: left">
                <img src="/lib/images/elastic-logo.png">
            </div>
            <div>
                <br/>
                <p>How to configure what is logged?</p>
            </div>
        </section>

        <section>
            <h2>Logging</h2>
            <section>
                <p>Can be changed dynamically</p>
                <pre><code data-trim>
PUT /_cluster/settings
{
    "transient" : {
        "logger.discovery" : "DEBUG"
    }
}                </code></pre>
            </section>
            <section>
                <h3>Slowlog</h3>
                <pre><code data-trim>
PUT /meetups/_settings
{
    "index.search.slowlog.threshold.query.warn" : "10s",
    "index.search.slowlog.threshold.fetch.debug": "500ms",
    "index.indexing.slowlog.threshold.index.info": "5s"
}
                </code></pre>
                <pre><code data-trim>
PUT /_cluster/settings
{
    "transient" : {
        "logger.index.search.slowlog" : "DEBUG",
        "logger.index.indexing.slowlog" : "WARN"
    }
}                </code></pre>
            </section>
            <section>
                <pre><code data-trim>
[2016-05-11 16:25:02,105][DEBUG][index.search.slowlog.query]
[meetups-20160509113909]took[518.5micros],took_millis[0],
types[], stats[], search_type[QUERY_AND_FETCH], total_shards[1]
, source[{"size":0,"aggs":{"byCity":{"terms":{"field":
"venue.city.raw","size":10}}}}], extra_source[],
                </code></pre>
            </section>
        </section>
        <section>
            <h2>Questions?</h2>
            <div style="float: left; width: 30%">
                <div>
                    <img src="/lib/images/aboutme/pasfoto-klein.jpg" width="200px">
                </div>
                <div>
                    <img src="/lib/images/luminisams_logo.png" width="200px"/>
                </div>
            </div>
            <div>
                <br/>
                <p style="text-align: left"><span class="callout">Twitter</span>: @jettroCoenradie</p>
                <p style="text-align: left"><span class="callout">Github</span>: https://github.com/jettro</p>
                <p style="text-align: left"><span class="callout">Blog</span>: https://amsterdam.luminis.eu/news/</p>
            </div>
            <div style="clear: both">
                <p><span class="callout">Licence</span>: http://creativecommons.org/licenses/by-nc-sa/3.0/</p>
            </div>
        </section>

    </div>

</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>

<script>

    // Full list of configuration options available at:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        transition: 'slide', // none/fade/slide/convex/concave/zoom

        // Optional reveal.js plugins
        dependencies: [
            {
                src: 'lib/js/classList.js', condition: function () {
                return !document.body.classList;
            }
            },
            {
                src: 'plugin/markdown/marked.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'plugin/markdown/markdown.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
//            {
//                src: 'plugin/highlight/highlight.js', async: true, callback: function () {
//                hljs.initHighlightingOnLoad();
//            }
//            },
            {src: 'lib/js/vendor/highlight.pack.js'},
            {
                src: 'node_modules/reveal-code-focus/reveal-code-focus.js',
                async: true,
                callback: function () {
                    RevealCodeFocus();
                    hljs.registerLanguage('javascript');
                }
            },
            {src: 'plugin/zoom-js/zoom.js', async: true},
            {src: 'plugin/notes/notes.js', async: true}
        ]
    });

</script>

</body>
</html>
