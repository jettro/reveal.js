<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Making your elastic cluster perform</title>

    <meta name="description" content="A presentation explaining the steps to take to run a healthy elastic cluster">
    <meta name="author" content="Jettro Coenradie">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/solarized.css" id="theme">

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>

<div class="reveal">

    <!-- Any section element inside of this container is displayed as a slide -->
    <div class="slides">
        <section>
            <h1>TODO</h1>
            <ul>
                <li>https://demoneaux.github.io/reveal-code-focus/#/</li>
                <li>https://www.elastic.co/elasticon/conf/2016/sf/elasticsearch-and-resiliency</li>
                <li>
                    https://www.elastic.co/elasticon/conf/2016/sf/stories-from-elastic-support-top-problems-and-solutions
                </li>
            </ul>
        </section>
        <section>
            <h1>Making your elastic cluster perform</h1>
            <p>
                <small>Created by <a href="http://twitter.com/jettroCoenradie">@jettroCoenradie</a></small>
            </p>
            <p>
                <img src="/lib/images/luminisams_logo.png">
            </p>
        </section>

        <section>
            <h2>Beginning with Elasticsearch</h2>
            <section data-background="/lib/images/elastic-cluster-full-color.jpg">
            </section>
            <section>
                <img src="/lib/images/firststeps/downloading-elasticsearch.png">
            </section>
            <section>
                <img src="/lib/images/firststeps/starting-elasticsearch.png">
            </section>
            <section>
            <pre><code class="hljs" data-trim contenteditable>
curl 'localhost:9200?pretty'
			</code></pre>
                <p>
                    Response
                </p>
<pre><code class="hljs" data-trim contenteditable>{
  "name" : "Tatterdemalion",
  "cluster_name" : "elasticsearch",
  "version" : {
    "number" : "2.3.1",
    "build_hash" : "bd980929010aef404e7cb0843e61d0665269fc39",
    "build_timestamp" : "2016-04-04T12:25:05Z",
    "build_snapshot" : false,
    "lucene_version" : "5.5.0"
  },
  "tagline" : "You Know, for Search"
}</code></pre>
            </section>
            <section>
            <pre><code class="hljs" data-trim contenteditable>
curl -XPOST 'localhost:9200/conferences/conference/1?pretty' -d '
{
  "name": "Codemotion Amsterdam",
  "location": "Kromhouthal"
}'
			</code></pre>
                <p>
                    Response
                </p>
                <pre><code class="hljs" data-trim contenteditable>{
  "_index" : "conferences",
  "_type" : "conference",
  "_id" : "1",
  "_version" : 1,
  "_shards" : {
    "total" : 2,
    "successful" : 1,
    "failed" : 0
  },
  "created" : true
}</code></pre>
            </section>
            <aside class="notes">
                First show how easy it is to start you node / cluster, insert documents and query them.
            </aside>
        </section>


        <section>
            <h2>Wow, what just happened?</h2>
            <section>
                <p class="fragment">Started a cluster and a node</p>
                <p class="fragment">We created an index</p>
                <p class="fragment">The index was created with a number of shards and replicas</p>
                <p class="fragment">The mapping was created for the fields we provided</>
            </section>
            <section>
                <p>All using the defaults</p>
            </section>
            <section>
                <table>
                    <thead>
                    <tr>
                        <th></th>
                        <th>default value</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>cluster name</td>
                        <td>elasticsearch</td>
                    </tr>
                    <tr class="fragment">
                        <td>node name</td>
                        <td>random marvel character</td>
                    </tr>
                    <tr class="fragment">
                        <td>num shards</td>
                        <td>5</td>
                    </tr>
                    <tr class="fragment">
                        <td>num replicas</td>
                        <td>1</td>
                    </tr>
                    <tr class="fragment">
                        <td>mappings</td>
                        <td>2 string fields</td>
                    </tr>
                    </tbody>
                </table>
            </section>
            <section>
                <p>That is a lot of defaults, but ...</p>
            </section>
            <aside class="notes">
                Explain what just happens, created an index, used a certain number of shards, replicas, created a
                mapping
            </aside>
        </section>

        <section>
            <h2>More questions than answers</h2>
            <ul>
                <li class="fragment">How many nodes?</li>
                <li class="fragment">How many shards?</li>
                <li class="fragment">How many replicas?</li>
                <li class="fragment">Provide a mapping?</li>
                <li class="fragment">Time based indices?</li>
                <li class="fragment">Can I change mappings?</li>
                <li class="fragment">Should I monitor my cluster?</li>
                <li class="fragment">What if queries are slow?</li>
                <li class="fragment">What if indexing takes to much time?</li>
            </ul>
            <aside class="notes">
                But using defaults is not the right way for most of these questions?
            </aside>
        </section>

        <section>
            <h2>Design your cluster</h2>
            <section>
                <p>How many nodes do I need?</p>
                <p>Think about split brain, minimum master nodes (n/2 + 1)</p>
                <p>Master is responsible for health of the cluster</p>
                <p>Create images with different setups</p>
            </section>
            <section>
                <p>Some reference numbers coming from elastic support</p>
                <p>Referentie naar presentatie geven</p>
                <p>Use max of 50% of your machine RAM for elastic</p>
                <p>Do not appoint more than 30500Mb RAM</p>
            </section>

            <aside class="notes">
                Talk about the number of nodes, the type of nodes, and a bit of connecting using clients. As a side step
                we could talk about security here, but I am not sure yet.
            </aside>
        </section>

        <section>
            <h2>Design your indices</h2>
            <section>
                <p>Create an image explaining what happens when you do a query (Index, shard, Lucene)</p>
            </section>
            <section>
                <p>Specify the amount of shards</p>
            </section>
            <section>
                <ul>
                    <li>Amount of docs or terms</li>
                    <li>Indexing speeds</li>
                    <li>Start small and test</li>
                    <li>Why not a lot of shards?</li>
                </ul>
            </section>
            <section>
                <p>Some reference numbers coming from elastic support</p>
                <p>Referentie naar presentatie geven</p>
                <p>Try not to make bigger shards than 50Gb</p>
            </section>
            <section>
                <p>Do you have time based indices?</p>
            </section>
            <section>
                <p>Maybe mention the _all field, can be expensive, especially if you do not need it.</p>
            </section>
            <section>
                <p>Should I use types?</p>
            </section>
            <aside class="notes">
                A very important thing to consider is whether you are using time based indices. Than think about
                the amount of shards that you would need and of course the amount of replicas.
            </aside>
        </section>

        <section>
            <h2>Design your mapping</h2>
            <section>
                <p>Maybe the hardest thing to do in the beginning.</p>
            </section>
            <section>
                <p>Why?</p>
            </section>
            <section>
                <p>A mapping is persistent, can only add new things.</p>
            </section>
            <section>
                <p>Create an index with one field: name</p>
                <pre><code class="hljs" data-trim contenteditable>
PUT /conferences
{
  "mappings": {
    "conference": {
      "properties": {
        "name": {
          "type": "string"
        }
      }
    }
  }
}
                </code></pre>
            </section>
            <section>
                <p>Retrieve the created mapping for the index</p>
                <pre><code class="hljs" data-trim contenteditable>
GET /conferences/_mapping

{
  "conferences": {
    "mappings": {
      "conference": {
        "properties": {
          "name": {
            "type": "string"
          }
        }
      }
    }
  }
}
                </code></pre>
            </section>
            <section>
                <p>The field is analyzed with the (default) standard analyzer</p>
            </section>
            <section>
                <p>What is an analyzer?</p>
                <p>Hier wil ik een plaatje hebben die laat zien wat een analyzer doet</p>
            </section>
            <section>
                <p>Most used analyzers (But there are a lot more)</p>
                <p>Tabel met analyzers</p>
            </section>
            <section>
                <p>We can analyze the same field multiple times</p>
                <p>Moeten hier even een code voorbeeld geven</p>
            </section>
            <section>
                <p>Not analyzed fields, can work with doc_values.</p>
                <p>Big advantage for sorting and aggregations</p>
            </section>
            <section>
                <p>Doc_values ?????</p>
            </section>
            <section>
                <p>From 2.3 use the keyword fields?????</p>
            </section>
            <section>
                <p>Structuring you model: objects - nested - parent/child</p>
            </section>
        </section>

        <section>
            <h2>Indexing documents</h2>
            <section>
                <p><a href="https://www.elastic.co/products/beats">Beats</a></p>
                <p><a href="https://www.elastic.co/products/logstash">Logstash</a></p>
                <p><a href="https://github.com/jprante/elasticsearch-jdbc">jdbc-importer</a></p>
                <p>Roll you own</p>
            </section>
        </section>

        <!-- Example of nested vertical slides -->
        <section>
            <section>
                <h2>Vertical Slides</h2>
                <p>Slides can be nested inside of each other.</p>
                <p>Use the <em>Space</em> key to navigate through all slides.</p>
                <br>
                <a href="#" class="navigate-down">
                    <img width="178" height="238" data-src="https://s3.amazonaws.com/hakim-static/reveal-js/arrow.png"
                         alt="Down arrow">
                </a>
            </section>
            <section>
                <h2>Basement Level 1</h2>
                <p>Nested slides are useful for adding additional detail underneath a high level horizontal slide.</p>
            </section>
            <section>
                <h2>Basement Level 2</h2>
                <p>That's it, time to go back up.</p>
                <br>
                <a href="#/2">
                    <img width="178" height="238" data-src="https://s3.amazonaws.com/hakim-static/reveal-js/arrow.png"
                         alt="Up arrow" style="transform: rotate(180deg); -webkit-transform: rotate(180deg);">
                </a>
            </section>
        </section>

        <section>
            <h2>Slides</h2>
            <p>
                Not a coder? Not a problem. There's a fully-featured visual editor for authoring these, try it out at <a
                    href="http://slides.com" target="_blank">http://slides.com</a>.
            </p>
        </section>

        <section>
            <h2>Point of View</h2>
            <p>
                Press <strong>ESC</strong> to enter the slide overview.
            </p>
            <p>
                Hold down alt and click on any element to zoom in on it using <a href="http://lab.hakim.se/zoom-js">zoom.js</a>.
                Alt + click anywhere to zoom back out.
            </p>
        </section>

        <section>
            <h2>Touch Optimized</h2>
            <p>
                Presentations look great on touch devices, like mobile phones and tablets. Simply swipe through your
                slides.
            </p>
        </section>

        <section data-markdown>
            <script type="text/template">
                ## Markdown support

                Write content using inline or external Markdown.
                Instructions and more info available in the [readme](https://github.com/hakimel/reveal.js#markdown).

                ```
                <section data-markdown>
                    ## Markdown support

                    Write content using inline or external Markdown.
                    Instructions and more info available in the [readme](https://github.com/hakimel/reveal.js#markdown).
                </section>
                ```
            </script>
        </section>

        <section>
            <section id="fragments">
                <h2>Fragments</h2>
                <p>Hit the next arrow...</p>
                <p class="fragment">... to step through ...</p>
                <p><span class="fragment">... a</span> <span class="fragment">fragmented</span> <span class="fragment">slide.</span>
                </p>

                <aside class="notes">
                    This slide has fragments which are also stepped through in the notes window.
                </aside>
            </section>
            <section>
                <h2>Fragment Styles</h2>
                <p>There's different types of fragments, like:</p>
                <p class="fragment grow">grow</p>
                <p class="fragment shrink">shrink</p>
                <p class="fragment fade-out">fade-out</p>
                <p class="fragment current-visible">current-visible</p>
                <p class="fragment highlight-red">highlight-red</p>
                <p class="fragment highlight-blue">highlight-blue</p>
            </section>
        </section>

        <section id="transitions">
            <h2>Transition Styles</h2>
            <p>
                You can select from different transitions, like: <br>
                <a href="?transition=none#/transitions">None</a> -
                <a href="?transition=fade#/transitions">Fade</a> -
                <a href="?transition=slide#/transitions">Slide</a> -
                <a href="?transition=convex#/transitions">Convex</a> -
                <a href="?transition=concave#/transitions">Concave</a> -
                <a href="?transition=zoom#/transitions">Zoom</a>
            </p>
        </section>

        <section id="themes">
            <h2>Themes</h2>
            <p>
                reveal.js comes with a few themes built in: <br>
                <!-- Hacks to swap themes after the page has loaded. Not flexible and only intended for the reveal.js demo deck. -->
                <a href="#"
                   onclick="document.getElementById('theme').setAttribute('href','css/theme/black.css'); return false;">Black
                    (default)</a> -
                <a href="#"
                   onclick="document.getElementById('theme').setAttribute('href','css/theme/white.css'); return false;">White</a>
                -
                <a href="#"
                   onclick="document.getElementById('theme').setAttribute('href','css/theme/league.css'); return false;">League</a>
                -
                <a href="#"
                   onclick="document.getElementById('theme').setAttribute('href','css/theme/sky.css'); return false;">Sky</a>
                -
                <a href="#"
                   onclick="document.getElementById('theme').setAttribute('href','css/theme/beige.css'); return false;">Beige</a>
                -
                <a href="#"
                   onclick="document.getElementById('theme').setAttribute('href','css/theme/simple.css'); return false;">Simple</a>
                <br>
                <a href="#"
                   onclick="document.getElementById('theme').setAttribute('href','css/theme/serif.css'); return false;">Serif</a>
                -
                <a href="#"
                   onclick="document.getElementById('theme').setAttribute('href','css/theme/blood.css'); return false;">Blood</a>
                -
                <a href="#"
                   onclick="document.getElementById('theme').setAttribute('href','css/theme/night.css'); return false;">Night</a>
                -
                <a href="#"
                   onclick="document.getElementById('theme').setAttribute('href','css/theme/moon.css'); return false;">Moon</a>
                -
                <a href="#"
                   onclick="document.getElementById('theme').setAttribute('href','css/theme/solarized.css'); return false;">Solarized</a>
            </p>
        </section>

        <section>
            <section data-background="#dddddd">
                <h2>Slide Backgrounds</h2>
                <p>
                    Set <code>data-background="#dddddd"</code> on a slide to change the background color. All CSS color
                    formats are supported.
                </p>
                <a href="#" class="navigate-down">
                    <img width="178" height="238" data-src="https://s3.amazonaws.com/hakim-static/reveal-js/arrow.png"
                         alt="Down arrow">
                </a>
            </section>
            <section data-background="https://s3.amazonaws.com/hakim-static/reveal-js/image-placeholder.png">
                <h2>Image Backgrounds</h2>
                <pre><code class="hljs">&lt;section data-background="image.png"&gt;</code></pre>
            </section>
            <section data-background="https://s3.amazonaws.com/hakim-static/reveal-js/image-placeholder.png"
                     data-background-repeat="repeat" data-background-size="100px">
                <h2>Tiled Backgrounds</h2>
                <pre><code class="hljs" style="word-wrap: break-word;">&lt;section data-background="image.png" data-background-repeat="repeat" data-background-size="100px"&gt;</code></pre>
            </section>
            <section
                    data-background-video="https://s3.amazonaws.com/static.slid.es/site/homepage/v1/homepage-video-editor.mp4,https://s3.amazonaws.com/static.slid.es/site/homepage/v1/homepage-video-editor.webm"
                    data-background-color="#000000">
                <div style="background-color: rgba(0, 0, 0, 0.9); color: #fff; padding: 20px;">
                    <h2>Video Backgrounds</h2>
                    <pre><code class="hljs" style="word-wrap: break-word;">&lt;section data-background-video="video.mp4,video.webm"&gt;</code></pre>
                </div>
            </section>
            <section data-background="http://i.giphy.com/90F8aUepslB84.gif">
                <h2>... and GIFs!</h2>
            </section>
        </section>

        <section data-transition="slide" data-background="#4d7e65" data-background-transition="zoom">
            <h2>Background Transitions</h2>
            <p>
                Different background transitions are available via the backgroundTransition option. This one's called
                "zoom".
            </p>
            <pre><code class="hljs">Reveal.configure({ backgroundTransition: 'zoom' })</code></pre>
        </section>

        <section data-transition="slide" data-background="#b5533c" data-background-transition="zoom">
            <h2>Background Transitions</h2>
            <p>
                You can override background transitions per-slide.
            </p>
            <pre><code class="hljs"
                       style="word-wrap: break-word;">&lt;section data-background-transition="zoom"&gt;</code></pre>
        </section>

        <section>
            <h2>Pretty Code</h2>
					<pre><code class="hljs" data-trim contenteditable>
function linkify( selector ) {
  if( supports3DTransforms ) {

    var nodes = document.querySelectorAll( selector );

    for( var i = 0, len = nodes.length; i &lt; len; i++ ) {
      var node = nodes[i];

      if( !node.className ) {
        node.className += ' roll';
      }
    }
  }
}
					</code></pre>
            <p>Code syntax highlighting courtesy of <a href="http://softwaremaniacs.org/soft/highlight/en/description/">highlight.js</a>.
            </p>
        </section>

        <section>
            <h2>Marvelous List</h2>
            <ul>
                <li>No order here</li>
                <li>Or here</li>
                <li>Or here</li>
                <li>Or here</li>
            </ul>
        </section>

        <section>
            <h2>Fantastic Ordered List</h2>
            <ol>
                <li>One is smaller than...</li>
                <li>Two is smaller than...</li>
                <li>Three!</li>
            </ol>
        </section>

        <section>
            <h2>Tabular Tables</h2>
            <table>
                <thead>
                <tr>
                    <th>Item</th>
                    <th>Value</th>
                    <th>Quantity</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>Apples</td>
                    <td>$1</td>
                    <td>7</td>
                </tr>
                <tr>
                    <td>Lemonade</td>
                    <td>$2</td>
                    <td>18</td>
                </tr>
                <tr>
                    <td>Bread</td>
                    <td>$3</td>
                    <td>2</td>
                </tr>
                </tbody>
            </table>
        </section>

        <section>
            <h2>Clever Quotes</h2>
            <p>
                These guys come in two forms, inline: <q
                    cite="http://searchservervirtualization.techtarget.com/definition/Our-Favorite-Technology-Quotations">
                &ldquo;The nice thing about standards is that there are so many to choose from&rdquo;</q> and block:
            </p>
            <blockquote
                    cite="http://searchservervirtualization.techtarget.com/definition/Our-Favorite-Technology-Quotations">
                &ldquo;For years there has been a theory that millions of monkeys typing at random on millions of
                typewriters would
                reproduce the entire works of Shakespeare. The Internet has proven this theory to be untrue.&rdquo;
            </blockquote>
        </section>

        <section>
            <h2>Intergalactic Interconnections</h2>
            <p>
                You can link between slides internally,
                <a href="#/2/3">like this</a>.
            </p>
        </section>

        <section>
            <h2>Speaker View</h2>
            <p>There's a <a href="https://github.com/hakimel/reveal.js#speaker-notes">speaker view</a>. It includes a
                timer, preview of the upcoming slide as well as your speaker notes.</p>
            <p>Press the <em>S</em> key to try it out.</p>

            <aside class="notes">
                Oh hey, these are some notes. They'll be hidden in your presentation, but you can see them if you open
                the speaker notes window (hit 's' on your keyboard).
            </aside>
        </section>

        <section>
            <h2>Export to PDF</h2>
            <p>Presentations can be <a href="https://github.com/hakimel/reveal.js#pdf-export">exported to PDF</a>,
                here's an example:</p>
            <iframe src="https://www.slideshare.net/slideshow/embed_code/42840540" width="445" height="355"
                    frameborder="0" marginwidth="0" marginheight="0" scrolling="no"
                    style="border:3px solid #666; margin-bottom:5px; max-width: 100%;" allowfullscreen></iframe>
        </section>

        <section>
            <h2>Global State</h2>
            <p>
                Set <code>data-state="something"</code> on a slide and <code>"something"</code>
                will be added as a class to the document element when the slide is open. This lets you
                apply broader style changes, like switching the page background.
            </p>
        </section>

        <section data-state="customevent">
            <h2>State Events</h2>
            <p>
                Additionally custom events can be triggered on a per slide basis by binding to the
                <code>data-state</code> name.
            </p>
					<pre><code class="javascript" data-trim contenteditable style="font-size: 18px;">
Reveal.addEventListener( 'customevent', function() {
	console.log( '"customevent" has fired' );
} );
					</code></pre>
        </section>

        <section>
            <h2>Take a Moment</h2>
            <p>
                Press B or . on your keyboard to pause the presentation. This is helpful when you're on stage and want
                to take distracting slides off the screen.
            </p>
        </section>

        <section>
            <h2>Much more</h2>
            <ul>
                <li>Right-to-left support</li>
                <li><a href="https://github.com/hakimel/reveal.js#api">Extensive JavaScript API</a></li>
                <li><a href="https://github.com/hakimel/reveal.js#auto-sliding">Auto-progression</a></li>
                <li><a href="https://github.com/hakimel/reveal.js#parallax-background">Parallax backgrounds</a></li>
                <li><a href="https://github.com/hakimel/reveal.js#keyboard-bindings">Custom keyboard bindings</a></li>
            </ul>
        </section>

        <section style="text-align: left;">
            <h1>THE END</h1>
            <p>
                - <a href="http://slides.com">Try the online editor</a> <br>
                - <a href="https://github.com/hakimel/reveal.js">Source code &amp; documentation</a>
            </p>
        </section>

    </div>

</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>

<script>

    // Full list of configuration options available at:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        transition: 'slide', // none/fade/slide/convex/concave/zoom

        // Optional reveal.js plugins
        dependencies: [
            {
                src: 'lib/js/classList.js', condition: function () {
                return !document.body.classList;
            }
            },
            {
                src: 'plugin/markdown/marked.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'plugin/markdown/markdown.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'plugin/highlight/highlight.js', async: true, callback: function () {
                hljs.initHighlightingOnLoad();
            }
            },
            {src: 'plugin/zoom-js/zoom.js', async: true},
            {src: 'plugin/notes/notes.js', async: true}
        ]
    });

</script>

</body>
</html>
